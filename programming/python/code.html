<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>code</title>
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<style type="text/css" >
pre.example {background-color: #ffffff;}
pre.src-python {background-color: #ffffff;}
</style>
</head>
<body>
<div id="content">
<h1 class="title">code</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">chapter 4: lists</a>
<ul>
<li><a href="#sec-1-1">allMyCats1.py</a></li>
<li><a href="#sec-1-2">allMyCats2.py</a></li>
<li><a href="#sec-1-3">myPets.py</a></li>
<li><a href="#sec-1-4">magic8Ball2.py</a></li>
<li><a href="#sec-1-5">passingReference.py</a></li>
</ul>
</li>
<li><a href="#sec-2">chapter 5: dictionaries and structuring data</a>
<ul>
<li><a href="#sec-2-1">birthdays.py</a></li>
<li><a href="#sec-2-2">characterCount.py</a></li>
<li><a href="#sec-2-3">prettyCharacterCount.py</a></li>
<li><a href="#sec-2-4">ticTacToe.py</a></li>
<li><a href="#sec-2-5">inventory.py</a></li>
</ul>
</li>
<li><a href="#sec-3">chapter 6: strings</a>
<ul>
<li><a href="#sec-3-1">catnapping.py</a></li>
<li><a href="#sec-3-2">validateInput.py</a></li>
<li><a href="#sec-3-3">picnicTable.py</a></li>
<li><a href="#sec-3-4">pw.py</a></li>
<li><a href="#sec-3-5">bulletPointAdder.py</a></li>
</ul>
</li>
<li><a href="#sec-4">chapter 12: excel</a>
<ul>
<li><a href="#sec-4-1">Opening Excel Documents with OpenPyXL</a></li>
<li><a href="#sec-4-2">Getting Sheets from the Workbook</a></li>
<li><a href="#sec-4-3">Getting Cells from the Sheets</a></li>
<li><a href="#sec-4-4">Converting Between Column Letters and Numbers</a></li>
<li><a href="#sec-4-5">Getting Rows and Columns from the Sheets</a></li>
<li><a href="#sec-4-6">Project: Reading Data from a Spreadsheet</a>
<ul>
<li><a href="#sec-4-6-1">readCensusExcel.py</a></li>
</ul>
</li>
<li><a href="#sec-4-7">Creating and Saving Excel Documents</a></li>
<li><a href="#sec-4-8">Creating and Removing Sheets</a></li>
<li><a href="#sec-4-9">Writing Values to Cells</a></li>
<li><a href="#sec-4-10">Project: Updating a Spreadsheet</a>
<ul>
<li><a href="#sec-4-10-1">updateProduce.py</a></li>
</ul>
</li>
<li><a href="#sec-4-11">Adjusting Rows and Columns</a>
<ul>
<li><a href="#sec-4-11-1">Setting Row Height and Column Width</a></li>
<li><a href="#sec-4-11-2">Merging and Unmerging Cells</a></li>
</ul>
</li>
<li><a href="#sec-4-12">Freeze Panes</a>
<ul>
<li><a href="#sec-4-12-1">Table 12-3: Frozen Pane Examples</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">chapter 4: lists</h2>
<div class="outline-text-2" id="text-1">
</div><div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1">allMyCats1.py</h3>
<div class="outline-text-3" id="text-1-1">
<div class="org-src-container">

<pre class="src src-python"># allMyCats1.py
# Working with Lists
# WORKS

print('Enter the name of cat 1:')
catName1 = input()
print('Enter the name of cat 2:')
catName2 = input()
print('Enter the name of cat 3:')
catName3 = input()
print('Enter the name of cat 4:')
catName4 = input()
print('Enter the name of cat 5:')
catName5 = input()
print('Enter the name of cat 6:')
catName6 = input()
print('The cat names are:')
print(catName1 + ' ' + catName2 + ' ' + catName3 + ' ' + catName4 + ' ' +
catName5 + ' ' + catName6)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2">allMyCats2.py</h3>
<div class="outline-text-3" id="text-1-2">
<div class="org-src-container">

<pre class="src src-python"># allMyCats2.py
# Working with Lists
# WORKS

catNames = []
while True:
    print('Enter the name of cat ' + str(len(catNames) + 1) +
    ' (Or enter nothing to stop.):')
    name = input()
    if name == '':
	break
    catNames = catNames + [name] # list concatenation
print('The cat names are:')
for name in catNames:
    print(' ' + name)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3">myPets.py</h3>
<div class="outline-text-3" id="text-1-3">
<div class="org-src-container">

<pre class="src src-python"># myPets.py
# The in and not in Operators
# WORKS

myPets = ['Zophie', 'Pooka', 'Fat-tail']
print('Enter a pet name:')
name = input()
if name not in myPets:
    print('I do not have a pet named ' + name)
else:
    print(name + ' is my pet.')
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-4" class="outline-3">
<h3 id="sec-1-4">magic8Ball2.py</h3>
<div class="outline-text-3" id="text-1-4">
<div class="org-src-container">

<pre class="src src-python"># magic8Ball2.py
# Example Program: Magic 8 Ball with a List
# WORKS

import random

messages = ['It is certain',
    'It is decidedly so',
    'Yes definitely',
    'Reply hazy try again',
    'Ask again later',
    'Concentrate and ask again',
    'My reply is no',
    'Outlook not so good',
    'Very doubtful']

print(messages[random.randint(0, len(messages) - 1)])
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-5" class="outline-3">
<h3 id="sec-1-5">passingReference.py</h3>
<div class="outline-text-3" id="text-1-5">
<div class="org-src-container">

<pre class="src src-python"># passingReference.py
# Passing References
# WORKS

def eggs(someParameter):
    someParameter.append('Hello')

spam = [1, 2, 3]
eggs(spam)
print(spam)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">chapter 5: dictionaries and structuring data</h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1">birthdays.py</h3>
<div class="outline-text-3" id="text-2-1">
<div class="org-src-container">

<pre class="src src-python"># birthdays.py
# Dictionaries vs. Lists
# WORKS

birthdays = {'Alice': 'Apr 1', 'Bob': 'Dec 12', 'Carol': 'Mar 4'}

while True:
    print('Enter a name: (blank to quit)')
    name = input()
    if name == '':
	break

    if name in birthdays:
	print(birthdays[name] + ' is the birthday of ' + name)
    else:
	print('I do not have birthday information for ' + name)
	print('What is their birthday?')
	bday = input()
	birthdays[name] = bday
	print('Birthday database updated.')
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2">characterCount.py</h3>
<div class="outline-text-3" id="text-2-2">
<div class="org-src-container">

<pre class="src src-python"># characterCount.py
# The setdefault() Method
# WORKS

message = 'It was a bright cold day in April, and the clocks were striking thirteen.'
count = {}

for character in message:
    count.setdefault(character, 0)
    count[character] = count[character] + 1
print(count)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-2-3" class="outline-3">
<h3 id="sec-2-3">prettyCharacterCount.py</h3>
<div class="outline-text-3" id="text-2-3">
<div class="org-src-container">

<pre class="src src-python"># prettyCharacterCount.py
# Pretty Printing
# WORKS

import pprint
message = 'It was a bright cold day in April, and the clocks were striking thirteen.'
count = {}

for character in message:
    count.setdefault(character, 0)
    count[character] = count[character] + 1

pprint.pprint(count)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-2-4" class="outline-3">
<h3 id="sec-2-4">ticTacToe.py</h3>
<div class="outline-text-3" id="text-2-4">
<div class="org-src-container">

<pre class="src src-python"># ticTacToe.py
# A Tic-Tac-Toe Board
# WORKS but not functional
# http://nostarch.com/automatestuff/ for full version

theBoard = {'top-L': ' ', 'top-M': ' ', 'top-R': ' ',
'mid-L': ' ', 'mid-M': ' ', 'mid-R': ' ',
'low-L': ' ', 'low-M': ' ', 'low-R': ' '}

def printBoard(board):
    print(board['top-L'] + '|' + board['top-M'] + '|' + board['top-R'])
    print('-+-+-')
    print(board['mid-L'] + '|' + board['mid-M'] + '|' + board['mid-R'])
    print('-+-+-')
    print(board['low-L'] + '|' + board['low-M'] + '|' + board['low-R'])
turn = 'X'
for i in range(9):
    printBoard(theBoard)
    print('Turn for ' + turn + '. Move on which space?')
    move = input()
    theBoard[move] = turn
    if turn == 'X':
	turn = 'O'
    else:
	turn = 'X'

printBoard(theBoard)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-2-5" class="outline-3">
<h3 id="sec-2-5">inventory.py</h3>
<div class="outline-text-3" id="text-2-5">
<div class="org-src-container">

<pre class="src src-python"># inventory.py
# Practice Projects
# WORKS. incomplete

stuff = {'rope': 1, 'torch': 6, 'gold coin': 42, 'dagger': 1, 'arrow': 12}
def displayInventory(inventory):
    print("Inventory:")
    item_total = 0
    for k, v in inventory.items():
	print(str(v) + ' ' + k)
	item_total += v
    print("Total number of items: " + str(item_total))
displayInventory(stuff)

#def addToInventory(inventory, addedItems):
    # your code goes here

#inv = {'gold coin': 42, 'rope': 1}
#dragonLoot = ['gold coin', 'dagger', 'gold coin', 'gold coin', 'ruby']
#inv = addToInventory(inv, dragonLoot)
#displayInventory(inv)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">chapter 6: strings</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1">catnapping.py</h3>
<div class="outline-text-3" id="text-3-1">
<div class="org-src-container">

<pre class="src src-python"># catnapping.py
# Multiline Strings with Triple Quotes
# WORKS

print('''Dear Alice,

Eve's cat has been arrested for catnapping, cat burglary, and extortion.

Sincerely,
Bob''')
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2">validateInput.py</h3>
<div class="outline-text-3" id="text-3-2">
<div class="org-src-container">

<pre class="src src-python"># validateInput.py
# The isX String Methods
# WORKS

while True:
    print('Enter your age:')
    age = input()
    if age.isdecimal():
	break
    print('Please enter a number for your age.')

while True:
    print('Select a new password (letters and numbers only):')
    password = input()
    if password.isalnum():
	break
    print('Passwords can only have letters and numbers.')
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-3" class="outline-3">
<h3 id="sec-3-3">picnicTable.py</h3>
<div class="outline-text-3" id="text-3-3">
<div class="org-src-container">

<pre class="src src-python"># picnicTable.py
# Justifying Text with rjust(), ljust(), and center()
# WORKS

def printPicnic(itemsDict, leftWidth, rightWidth):
    print('PICNIC ITEMS'.center(leftWidth + rightWidth, '-'))
    for k, v in itemsDict.items():
	print(k.ljust(leftWidth, '.') + str(v).rjust(rightWidth))

picnicItems = {'sandwiches': 4, 'apples': 12, 'cups': 4, 'cookies': 8000}
printPicnic(picnicItems, 12, 5)
printPicnic(picnicItems, 20, 6)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-4" class="outline-3">
<h3 id="sec-3-4">pw.py</h3>
<div class="outline-text-3" id="text-3-4">
<div class="org-src-container">

<pre class="src src-python">#! python3
# pw.py - An insecure password locker program.
# Project: Password Locker
# install pyperclip module
# Pyperclip could not find a copy/paste mechanism for your system.
# yum install xclip
# WORKS

PASSWORDS = {'email': 'F7minlBDDuvMJuxESSKHFhTxFtjVB6',
	     'blog': 'VmALvQyKAxiVH5G8v01if1MLZF3sdt',
	     'luggage': '12345'}

import sys, pyperclip
if len(sys.argv) &lt; 2:
    print('Usage: py pw.py [account] - copy account password')
    sys.exit()

account = sys.argv[1]   # first command line arg is the account name

if account in PASSWORDS:
    pyperclip.copy(PASSWORDS[account])
    print('Password for ' + account + ' copied to clipboard.')
else:
    print('There is no account named ' + account)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-5" class="outline-3">
<h3 id="sec-3-5">bulletPointAdder.py</h3>
<div class="outline-text-3" id="text-3-5">
<div class="org-src-container">

<pre class="src src-python">#! python3
# bulletPointAdder.py - Adds Wikipedia bullet points to the start
# of each line of text on the clipboard.
# Project: Adding Bullets to Wiki Markup
# WORKS

import pyperclip
text = pyperclip.paste()

# Separate lines and add stars.
lines = text.split('\n')
for i in range(len(lines)):    # loop through all indexes for "lines" list
    lines[i] = '* ' + lines[i] # add star to each string in "lines" list
text = '\n'.join(lines)
pyperclip.copy(text)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">chapter 12: excel</h2>
<div class="outline-text-2" id="text-4">
</div><div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1">Opening Excel Documents with OpenPyXL</h3>
<div class="outline-text-3" id="text-4-1">
<pre class="example">
&gt;&gt;&gt; import openpyxl
&gt;&gt;&gt; wb = openpyxl.load_workbook('example.xlsx')
&gt;&gt;&gt; type(wb)
&lt;class 'openpyxl.workbook.workbook.Workbook'&gt;
</pre>
</div>
</div>

<div id="outline-container-sec-4-2" class="outline-3">
<h3 id="sec-4-2">Getting Sheets from the Workbook</h3>
<div class="outline-text-3" id="text-4-2">
<pre class="example">
&gt;&gt;&gt; import openpyxl
&gt;&gt;&gt; wb = openpyxl.load_workbook('example.xlsx')
&gt;&gt;&gt; type(wb)
&lt;class 'openpyxl.workbook.workbook.Workbook'&gt;
&gt;&gt;&gt; import openpyxl
&gt;&gt;&gt; wb = openpyxl.load_workbook('example.xlsx')
&gt;&gt;&gt; wb.get_sheet_names()
['Sheet1', 'Sheet2', 'Sheet3']
&gt;&gt;&gt; sheet = wb.get_sheet_by_name('Sheet3')
&gt;&gt;&gt; sheet
&lt;Worksheet "Sheet3"&gt;
&gt;&gt;&gt; type(sheet)
&lt;class 'openpyxl.worksheet.worksheet.Worksheet'&gt;
&gt;&gt;&gt; sheet.title
'Sheet3'
&gt;&gt;&gt; anotherSheet = wb.get_active_sheet()
&gt;&gt;&gt; anotherSheet
&lt;Worksheet "Sheet1"&gt;
</pre>
</div>
</div>

<div id="outline-container-sec-4-3" class="outline-3">
<h3 id="sec-4-3">Getting Cells from the Sheets</h3>
<div class="outline-text-3" id="text-4-3">
<pre class="example">
&gt;&gt;&gt; import openpyxl
&gt;&gt;&gt; wb = openpyxl.load_workbook('example.xlsx')
&gt;&gt;&gt; sheet = wb.get_sheet_by_name('Sheet1')
&gt;&gt;&gt; sheet['A1']
&lt;Cell 'Sheet1'.A1&gt;
&gt;&gt;&gt; sheet['A1'].value
datetime.datetime(2015, 4, 5, 13, 34, 2)
&gt;&gt;&gt; c = sheet['B1']
&gt;&gt;&gt; c.value
'Apples'
&gt;&gt;&gt; 'Row ' + str(c.row) + ', Column ' + c.column + ' is ' + c.value
'Row 1, Column B is Apples'
&gt;&gt;&gt; 'Cell ' + c.coordinate + ' is ' + c.value
'Cell B1 is Apples'
&gt;&gt;&gt; sheet['C1'].value
73
&gt;&gt;&gt;
</pre>

<pre class="example">
&gt;&gt;&gt; sheet.cell(row=1, column=2)
&lt;Cell 'Sheet1'.B1&gt;
&gt;&gt;&gt; sheet.cell(row=1, column=2).value
'Apples'
&gt;&gt;&gt; for i in range(1, 8, 2):
...     print(i, sheet.cell(row=i, column=2).value)
... 
1 Apples
3 Pears
5 Apples
7 Strawberries
</pre>

<pre class="example">
&gt;&gt;&gt; import openpyxl
&gt;&gt;&gt; wb = openpyxl.load_workbook('example.xlsx')
&gt;&gt;&gt; sheet = wb.get_sheet_by_name('Sheet1')
&gt;&gt;&gt; sheet.max_row
7
&gt;&gt;&gt; sheet.max_column
3
&gt;&gt;&gt;
</pre>
</div>
</div>

<div id="outline-container-sec-4-4" class="outline-3">
<h3 id="sec-4-4">Converting Between Column Letters and Numbers</h3>
<div class="outline-text-3" id="text-4-4">
<pre class="example">
&gt;&gt;&gt; import openpyxl
&gt;&gt;&gt; from openpyxl.utils import get_column_letter, column_index_from_string
&gt;&gt;&gt; get_column_letter(1)
'A'
&gt;&gt;&gt; get_column_letter(2)
'B'
&gt;&gt;&gt; get_column_letter(27)
'AA'
&gt;&gt;&gt; get_column_letter(900)
'AHP'
&gt;&gt;&gt; wb = openpyxl.load_workbook('example.xlsx')
&gt;&gt;&gt; sheet = wb.get_sheet_by_name('Sheet1')
&gt;&gt;&gt; get_column_letter(sheet.max_column)
'C'
&gt;&gt;&gt; column_index_from_string('A')
1
&gt;&gt;&gt; column_index_from_string('AA')
27
</pre>
</div>
</div>

<div id="outline-container-sec-4-5" class="outline-3">
<h3 id="sec-4-5">Getting Rows and Columns from the Sheets</h3>
<div class="outline-text-3" id="text-4-5">
<pre class="example">
&gt;&gt;&gt; import openpyxl
&gt;&gt;&gt; wb = openpyxl.load_workbook('example.xlsx')
&gt;&gt;&gt; sheet = wb.get_sheet_by_name('Sheet1')
&gt;&gt;&gt; tuple(sheet['A1':'C3'])
((&lt;Cell 'Sheet1'.A1&gt;, &lt;Cell 'Sheet1'.B1&gt;, &lt;Cell 'Sheet1'.C1&gt;), (&lt;Cell 'Sheet1'.A2&gt;, 
&lt;Cell 'Sheet1'.B2&gt;, &lt;Cell 'Sheet1'.C2&gt;), (&lt;Cell 'Sheet1'.A3&gt;, &lt;Cell 'Sheet1'.B3&gt;, 
&lt;Cell 'Sheet1'.C3&gt;))
&gt;&gt;&gt; for rowOfCellObjects in sheet['A1':'C3']:
...     for cellObj in rowOfCellObjects:
...         print(cellObj.coordinate, cellObj.value)
...     print('--- END OF ROW ---')
... 
A1 2015-04-05 13:34:02
B1 Apples
C1 73
--- END OF ROW ---
A2 2015-04-05 03:41:23
B2 Cherries
C2 85
--- END OF ROW ---
A3 2015-04-06 12:46:51
B3 Pears
C3 14
--- END OF ROW ---
</pre>

<pre class="example">
&gt;&gt;&gt; import openpyxl
&gt;&gt;&gt; wb = openpyxl.load_workbook('example.xlsx')
&gt;&gt;&gt; sheet = wb.get_active_sheet()
&gt;&gt;&gt; list(sheet.columns)[1]
(&lt;Cell 'Sheet1'.B1&gt;, &lt;Cell 'Sheet1'.B2&gt;, &lt;Cell 'Sheet1'.B3&gt;, &lt;Cell 'Sheet1'.B4&gt;, 
&lt;Cell 'Sheet1'.B5&gt;, &lt;Cell 'Sheet1'.B6&gt;, &lt;Cell 'Sheet1'.B7&gt;)
&gt;&gt;&gt; for cellObj in list(sheet.columns)[1]:
...     print(cellObj.value)
... 
Apples
Cherries
Pears
Oranges
Apples
Bananas
Strawberries
</pre>
</div>
</div>

<div id="outline-container-sec-4-6" class="outline-3">
<h3 id="sec-4-6">Project: Reading Data from a Spreadsheet</h3>
<div class="outline-text-3" id="text-4-6">
<p>
<code>censuspopdata.xlsx</code>
</p>
</div>

<div id="outline-container-sec-4-6-1" class="outline-4">
<h4 id="sec-4-6-1">readCensusExcel.py</h4>
<div class="outline-text-4" id="text-4-6-1">
<div class="org-src-container">

<pre class="src src-python">#! python3
# readCensusExcel.py - Tabulates population and number of census tracts for
# each county.

import openpyxl, pprint
print('Opening workbook...')
wb = openpyxl.load_workbook('censuspopdata.xlsx')
sheet = wb.get_sheet_by_name('Population by Census Tract')
countyData = {}

# Fill in countyData with each county's population and tracts.
print('Reading rows...')
for row in range(2, sheet.max_row + 1):
    # Each row in the spreadsheet has data for one census tract.
    state = sheet['B' + str(row)].value
    county = sheet['C' + str(row)].value
    pop = sheet['D' + str(row)].value

    # Make sure the key for this state exists.
    countyData.setdefault(state, {})
    # Make sure the key for this county in this state exists.
    countyData[state].setdefault(county, {'tracts': 0, 'pop': 0})

    # Each row represents one census tract, so increment by one.
    countyData[state][county]['tracts'] += 1
    # Increase the county pop by the pop in this census tract.
    countyData[state][county]['pop'] += int(pop)

# Open a new text file and write the contents of countyData to it.
print('Writing results...')
resultFile = open('census2010.py', 'w')
resultFile.write('allData = ' + pprint.pformat(countyData))
resultFile.close()
print('Done.')
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; import census2010
&gt;&gt;&gt; census2010.allData['AK']['Anchorage']
{'pop': 291826, 'tracts': 55}
&gt;&gt;&gt; anchoragePop = census2010.allData['AK']['Anchorage']['pop']
&gt;&gt;&gt; print('The 2010 population of Anchorage was ' + str(anchoragePop))
The 2010 population of Anchorage was 291826
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-4-7" class="outline-3">
<h3 id="sec-4-7">Creating and Saving Excel Documents</h3>
<div class="outline-text-3" id="text-4-7">
<pre class="example">
&gt;&gt;&gt; import openpyxl
&gt;&gt;&gt; wb = openpyxl.Workbook()
&gt;&gt;&gt; wb.get_sheet_names()
['Sheet']
&gt;&gt;&gt; sheet = wb.get_active_sheet()
&gt;&gt;&gt; sheet.title
'Sheet'
&gt;&gt;&gt; sheet.title = 'Spam Bacon Eggs Sheet'
&gt;&gt;&gt; wb.get_sheet_names()
['Spam Bacon Eggs Sheet']
</pre>

<pre class="example">
&gt;&gt;&gt; import openpyxl
&gt;&gt;&gt; wb = openpyxl.load_workbook('example.xlsx')
&gt;&gt;&gt; sheet = wb.get_active_sheet()
&gt;&gt;&gt; sheet.title = 'Spam Spam Spam'
&gt;&gt;&gt; wb.save('example_copy.xlsx')
</pre>
</div>
</div>

<div id="outline-container-sec-4-8" class="outline-3">
<h3 id="sec-4-8">Creating and Removing Sheets</h3>
<div class="outline-text-3" id="text-4-8">
<pre class="example">
&gt;&gt;&gt; import openpyxl
&gt;&gt;&gt; wb = openpyxl.Workbook()
&gt;&gt;&gt; wb.get_sheet_names()
['Sheet']
&gt;&gt;&gt; wb.create_sheet()
&lt;Worksheet "Sheet1"&gt;
&gt;&gt;&gt; wb.get_sheet_names()
['Sheet', 'Sheet1']
&gt;&gt;&gt; wb.create_sheet(index=0, title='First Sheet')
&lt;Worksheet "First Sheet"&gt;
&gt;&gt;&gt; wb.get_sheet_names()
['First Sheet', 'Sheet', 'Sheet1']
&gt;&gt;&gt; wb.create_sheet(index=2, title='Middle Sheet')
&lt;Worksheet "Middle Sheet"&gt;
&gt;&gt;&gt; wb.get_sheet_names()
['First Sheet', 'Sheet', 'Middle Sheet', 'Sheet1']
&gt;&gt;&gt; wb.remove_sheet(wb.get_sheet_by_name('Middle Sheet'))
&gt;&gt;&gt; wb.remove_sheet(wb.get_sheet_by_name('Sheet1'))
&gt;&gt;&gt; wb.get_sheet_names()
['First Sheet', 'Sheet']
</pre>
</div>
</div>

<div id="outline-container-sec-4-9" class="outline-3">
<h3 id="sec-4-9">Writing Values to Cells</h3>
<div class="outline-text-3" id="text-4-9">
<pre class="example">
&gt;&gt;&gt; import openpyxl
&gt;&gt;&gt; wb = openpyxl.Workbook()
&gt;&gt;&gt; sheet = wb.get_sheet_by_name('Sheet')
&gt;&gt;&gt; sheet['A1'] = 'Hello world!'
&gt;&gt;&gt; sheet['A1'].value
'Hello world!'
</pre>
</div>
</div>

<div id="outline-container-sec-4-10" class="outline-3">
<h3 id="sec-4-10">Project: Updating a Spreadsheet</h3>
<div class="outline-text-3" id="text-4-10">
<p>
<code>produceSales.xlsx</code>
</p>
</div>

<div id="outline-container-sec-4-10-1" class="outline-4">
<h4 id="sec-4-10-1">updateProduce.py</h4>
<div class="outline-text-4" id="text-4-10-1">
<div class="org-src-container">

<pre class="src src-python">#! python3
# updateProduce.py - Corrects costs in produce sales spreadsheet.
# works

import openpyxl

wb = openpyxl.load_workbook('produceSales.xlsx')
sheet = wb.get_sheet_by_name('Sheet')

# The produce types and their updated prices
PRICE_UPDATES = {'Garlic': 3.07,
		 'Celery': 1.19,
		 'Lemon': 1.27}

# Loop through the rows and update the prices.
for rowNum in range(2, sheet.max_row): # skip the first row
    produceName = sheet.cell(row=rowNum, column=1).value
    if produceName in PRICE_UPDATES:
	sheet.cell(row=rowNum, column=2).value = PRICE_UPDATES[produceName]

wb.save('updatedProduceSales.xlsx')
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-4-11" class="outline-3">
<h3 id="sec-4-11">Adjusting Rows and Columns</h3>
<div class="outline-text-3" id="text-4-11">
</div><div id="outline-container-sec-4-11-1" class="outline-4">
<h4 id="sec-4-11-1">Setting Row Height and Column Width</h4>
<div class="outline-text-4" id="text-4-11-1">
<pre class="example">
&gt;&gt;&gt; import openpyxl
&gt;&gt;&gt; wb = openpyxl.Workbook()
&gt;&gt;&gt; sheet = wb.get_active_sheet()
&gt;&gt;&gt; sheet['A1'] = 'Tall row'
&gt;&gt;&gt; sheet['B2'] = 'Wide column'
&gt;&gt;&gt; sheet.row_dimensions[1].height = 70
&gt;&gt;&gt; sheet.column_dimensions['B'].width = 20
&gt;&gt;&gt; wb.save('dimensions.xlsx')
</pre>
</div>
</div>

<div id="outline-container-sec-4-11-2" class="outline-4">
<h4 id="sec-4-11-2">Merging and Unmerging Cells</h4>
<div class="outline-text-4" id="text-4-11-2">
<pre class="example">
&gt;&gt;&gt; import openpyxl
&gt;&gt;&gt; wb = openpyxl.Workbook()
&gt;&gt;&gt; sheet = wb.get_active_sheet()
&gt;&gt;&gt; sheet.merge_cells('A1:D3')
&gt;&gt;&gt; sheet['A1'] = 'Twelve cells merged together.'
&gt;&gt;&gt; sheet.merge_cells('C5:D5')
&gt;&gt;&gt; sheet['C5'] = 'Two merged cells.'
&gt;&gt;&gt; wb.save('merged.xlsx')
</pre>

<pre class="example">
&gt;&gt;&gt; import openpyxl
&gt;&gt;&gt; wb = openpyxl.load_workbook('merged.xlsx')
&gt;&gt;&gt; sheet = wb.get_active_sheet()
&gt;&gt;&gt; sheet.unmerge_cells('A1:D3')
&gt;&gt;&gt; sheet.unmerge_cells('C5:D5')
&gt;&gt;&gt; wb.save('merged.xlsx')
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-4-12" class="outline-3">
<h3 id="sec-4-12">Freeze Panes</h3>
<div class="outline-text-3" id="text-4-12">
</div><div id="outline-container-sec-4-12-1" class="outline-4">
<h4 id="sec-4-12-1">Table 12-3: Frozen Pane Examples</h4>
<div class="outline-text-4" id="text-4-12-1">
<pre class="example">
| freeze_panes setting                                   | Rows and columns frozen   |
|--------------------------------------------------------+---------------------------|
| sheet.freeze_panes = 'A2'                              | Row 1                     |
| sheet.freeze_panes = 'B1'                              | Column A                  |
| sheet.freeze_panes = 'C1'                              | Columns A and B           |
| sheet.freeze_panes = 'C2'                              | Row 1 and columns A and B |
| sheet.freeze_panes = 'A1' or sheet.freeze_panes = None | No frozen panes           |
</pre>

<pre class="example">
&gt;&gt;&gt; import openpyxl
&gt;&gt;&gt; wb = openpyxl.load_workbook('produceSales.xlsx')
&gt;&gt;&gt; sheet = wb.get_active_sheet()
&gt;&gt;&gt; sheet.freeze_panes = 'A2'
&gt;&gt;&gt; wb.save('freezeExample.xlsx')
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="validation"></p>
</div>
</body>
</html>
